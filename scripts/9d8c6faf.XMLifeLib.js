var XMLife={};XMLife.Protocol="com.paitao.xmlife://",XMLife.downloadURL="http://d.xiaomei.com",XMLife.URI={shop_URI:"view/shop/",product_URI:"view/product/",template_URI:"view/template/",coupon_URI:"qrcode/coupon/",charge_URI:"qrcode/charge/",count_URI:"charge/detail/",shelf_URI:"view/shelf?"},XMLife.alertMsg={shareFailure:"分享初始化失败！"},XMLife.system={versions:function(){var a=navigator.userAgent;return{ios:!!a.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:a.indexOf("Android")>-1||a.indexOf("Linux")>-1}}()},XMLife.getSubStringByByte=function(a,b,c){for(var d=0,e=0,f=a.length;f>e;e++){var g=a.charCodeAt(e);if(g>=1&&126>=g||g>=65376&&65439>=g?d++:d+=2,d>=c)return a.substring(b,e+1)}return a},XMLife.isArray=function(a){return"[object Array]"==Object.prototype.toString.call(a)},XMLife.strByteLength=function(a){for(var b=0,c=0,d=a.length;d>c;c++){var e=a.charCodeAt(c);e>=1&&126>=e||e>=65376&&65439>=e?b++:b+=2}return b},XMLife.getTop=function(a){var b=a.offsetTop;return null!=a.offsetParent&&(b+=XMLife.getTop(a.offsetParent)),b},XMLife.getLeft=function(a){var b=a.offsetLeft;return null!=a.offsetParent&&(b+=XMLife.getLeft(a.offsetParent)),b},XMLife.hasClass=function(a,b){return a.className.match(new RegExp("(\\s|^)"+b+"(\\s|$)"))},XMLife.addClass=function(a,b){XMLife.hasClass(a,b)||(a.className+=" "+b)},XMLife.removeClass=function(a,b){if(XMLife.hasClass(a,b)){var c=new RegExp("(\\s|^)"+b+"(\\s|$)");a.className=a.className.replace(c,"")}},XMLife.isWeChat=function(){var a=navigator.userAgent.toLowerCase();return"micromessenger"==a.match(/MicroMessenger/i)},XMLife.isQQ=function(){var a=navigator.userAgent.toLowerCase();return"qq"==a.match(/QQ/i)},XMLife.isXMLife=function(){var a=navigator.userAgent.toLowerCase();return"xl_c"==a.match(/Xl_c/i)},XMLife.isPC=function(){for(var a=navigator.userAgent,b=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],c=!0,d=0;d<b.length;d++)if(a.indexOf(b[d])>0){c=!1;break}return c},XMLife.addEvent=function(a,b,c,d){if(a.addEventListener)return a.addEventListener(b,c,d),!0;if(a.attachEvent){var e=a.attachEvent("on"+b,c);return e}a["on"+b]=c},XMLife.getParameterByName=function(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b=new RegExp("[\\?&]"+a+"=([^&#]*)"),c=b.exec(location.search);return null===c?"":decodeURIComponent(c[1].replace(/\+/g," "))},XMLife.styleToggle=function(a,b,c){for(var d=a||[],e=b||[],f=c||[],g=0,h=d.length;h>g;g++)!function(a){XMLife.addEvent(d[a],"touchstart",function(){XMLife.hasClass(d[a],e[a])&&(XMLife.removeClass(d[a],e[a]),XMLife.addClass(d[a],f[a]))},!1),XMLife.addEvent(d[a],"touchend",function(){XMLife.hasClass(d[a],f[a])&&(XMLife.removeClass(d[a],f[a]),XMLife.addClass(d[a],e[a]))},!1)}(g)},XMLife.clickBind=function(a,b,c,d,e,f){for(var g=a||"product",b=b||[],c=c||[],h=0,i=b.length;i>h;h++)!function(a){var h="";h=XMLife.Protocol+XMLife.URI[g+"_URI"],XMLife.addEvent(b[a],"click",function(){var b;b=void 0!==f?h+c[a][f]:h+c[a],XMLife.openApp(b,d,e)})}(h)},XMLife.openApp=function(a,b,c){XMLife.system.versions.ios?XMLife.isWeChat()?(window.location.href=a,setTimeout(function(){window.location.href=XMLife.downloadURL},500)):XMLife.isQQ()||(XMLife.isXMLife()?window.location.href=a:(window.location.href=a,setTimeout(function(){b?b.call(this,c):null,window.location=XMLife.downloadURL},1500))):XMLife.isWeChat()?(window.location.href=a,setTimeout(function(){window.location.href=XMLife.downloadURL},500)):XMLife.isQQ()||(XMLife.isXMLife()?window.location.href=a:(window.location.href=a,setTimeout(function(){b?b.call(this,c):null,window.location=XMLife.downloadURL},1500)))},XMLife.xmShareInit=function(a,b,c,d){var e=document.createElement("meta"),f=document.createElement("meta"),g=document.createElement("meta"),h=document.createElement("meta");e.name="share-title",f.name="share-desc",g.name="share-icon",h.name="share-link",e.content=XMLife.isArray(a)?a[0]:a,f.content=b,g.content=d,h.content=c,document.head.appendChild(e),document.head.appendChild(f),document.head.appendChild(g),document.head.appendChild(h)},XMLife.weChartInit=function(a,b,c,d,e,f,g){var h=window.wx,i=a[0],j=a[1],k=a[2],l=a[3],m=[];if(h.config({debug:!1,appId:i,nonceStr:k,timestamp:j,signature:l,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo"]}),XMLife.isArray(b))for(var n=0;4>n;n++)m.push(b[n]?b[n]:b[b.length-1]);else for(var o=0;4>o;o++)m.push(b);h.ready(function(){h.onMenuShareAppMessage({title:m[0],desc:c,link:d,imgUrl:e,type:"",dataUrl:""}),h.onMenuShareTimeline({title:m[1],link:d,imgUrl:e}),h.onMenuShareWeibo({title:m[2],desc:c,link:d,imgUrl:e}),h.onMenuShareQQ({title:m[3],desc:c,link:d,imgUrl:e}),f?f.apply(this,g):null})},XMLife.HtmlShareInit=function(a,b,c,d,e,f){var g=window.httpUrl;XMLife.xmShareInit(a,b,c,d),$&&g?$.ajax({url:"http://"+g+"/biz/rest/share/wechat/token",type:"GET",data:{url:c},dataType:"jsonp",jsonp:"jsoncallback",timeout:3e4,success:function(g){XMLife.weChartInit([g.appId,g.timestamp,g.nonceStr,g.signature],a,b,c,d,e,f)},error:function(){window.alert(XMLife.alertMsg.shareFailure)}}):window.alert(XMLife.alertMsg.shareFailure)},XMLife.initUserFont=function(a){var b,c=document.getElementsByClassName(a),d=c.length||0,e=parseFloat((document.body.clientWidth/100).toFixed(2));for(b=0;d>b;b++)c[b].style.fontSize=(parseInt(c[b].getAttribute("size"))*e).toFixed(2)+"px"};