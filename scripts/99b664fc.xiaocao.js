!function(a){var b=this,c="http://"+httpUrl+"/biz/rest/share/draw/out/coupon",d="http://"+httpUrl+"/biz/rest/share/wechat/token",e=document.getElementById("phone"),f=document.getElementById("button_get"),g=document.getElementById("download_btn"),h=/^[\d]{11}$/,i=window.wx,j=function(){var a=function(a,b,c,d){var e=document.getElementById("logo").src,f="你的菜钱我出了！快来抢红包一起用~",g="蔬果生鲜，食品百货：超市代买，1小时速达！";i.config({debug:!1,appId:a,nonceStr:c,timestamp:b,signature:d,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo"]}),i.ready(function(){i.onMenuShareTimeline({title:f,link:"",imgUrl:e}),i.onMenuShareAppMessage({title:f,desc:g,link:"",imgUrl:e,type:"",dataUrl:""}),i.onMenuShareQQ({title:f,desc:g,link:"",imgUrl:e}),i.onMenuShareWeibo({title:f,desc:g,link:"",imgUrl:e}),i.hideOptionMenu()})},b=function(b){var c=b.appId,d=b.timestamp,e=b.nonceStr,f=b.signature;a(c,d,e,f)},c=function(){};$.ajax({url:d,type:"GET",data:{url:window.location.href.split("#")[0]},dataType:"jsonp",jsonp:"jsoncallback",success:b,error:c})};j();var k=function(){var b=e.value,d=a.getParameterByName("ruleId"),g=function(a){var b=a.isPass,c=a.errorCode,d={802:["您的卡券太多啦!","赶紧去花掉一些~"],806:["今天领了很多啦!","明天再接再厉哦~"],823:["领过了!","留点机会给别人吧~"],820:["过期了!","下次早点来哦~"],821:["过期了!","下次早点来哦~"],expired:["过期了!","下次早点来哦~"],other:["领完啦!","下次早点来哦~"]},e="",f="";b?window.alert("已抢到！"):(d[c]?(e=d[c][0],f=d[c][1]):(e=d.other[0],f=d.other[1]),window.alert(e+":"+f))},h=function(){window.alert("获取失败！")};a.hasClass(f,"active")&&$.ajax({url:c,type:"GET",data:{phone:b,ruleId:d},dataType:"jsonp",jsonp:"jsoncallback",success:g,failure:h})};a.addEvent(e,"input",function(){h.test(e.value)?a.addClass(f,"active"):a.removeClass(f,"active")}),a.addEvent(f,"touchstart",function(b){b.preventDefault(),a.addClass(f,"down")},b),a.addEvent(f,"touchend",function(b){b.preventDefault(),a.removeClass(f,"down"),h.test(e.value)&&k()}),a.addEvent(g,"touchstart",function(){a.addClass(g,"down")},b),a.addEvent(g,"touchend",function(){a.removeClass(g,"down"),window.location.href=a.downloadURL},b)}(XMLife);